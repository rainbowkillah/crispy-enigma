> npm run typecheck


> typecheck
> tsc -p tsconfig.json --noEmit

apps/worker-api/src/index.ts(896,42): error TS2352: Conversion of type '{ matches: never[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: never[]; }' but required in type 'VectorizeMatches'.
packages/observability/src/metrics.ts(83,19): error TS2339: Property 'cursor' does not exist on type 'KVNamespaceListResult<unknown, string>'.
  Property 'cursor' does not exist on type '{ list_complete: true; keys: KVNamespaceListKey<unknown, string>[]; cacheStatus: string | null; }'.
packages/rag/src/retrieval.ts(59,12): error TS2352: Conversion of type '{ matches: never[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: never[]; }' but required in type 'VectorizeMatches'.
packages/rag/src/vectorize.ts(38,29): error TS2352: Conversion of type '{ count: number; }' to type 'VectorizeAsyncMutation' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'mutationId' is missing in type '{ count: number; }' but required in type 'VectorizeAsyncMutation'.
packages/rag/src/vectorize.ts(42,9): error TS2322: Type '{ id: string; values: number[]; metadata: VectorizeRecordMetadata; }[]' is not assignable to type 'VectorizeVector[]'.
  Type '{ id: string; values: number[]; metadata: VectorizeRecordMetadata; }' is not assignable to type 'VectorizeVector'.
    Types of property 'metadata' are incompatible.
      Type 'VectorizeRecordMetadata' is not assignable to type 'Record<string, VectorizeVectorMetadata>'.
        'string' index signatures are incompatible.
          Type 'string | number | boolean | undefined' is not assignable to type 'VectorizeVectorMetadata'.
            Type 'undefined' is not assignable to type 'VectorizeVectorMetadata'.
tests/ingest-search.test.ts(34,12): error TS2352: Conversion of type '{ count: number; }' to type 'VectorizeAsyncMutation' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'mutationId' is missing in type '{ count: number; }' but required in type 'VectorizeAsyncMutation'.
tests/ingest-search.test.ts(39,12): error TS2352: Conversion of type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; text: string; }; }[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; text: string; }; }[]; }' but required in type 'VectorizeMatches'.
tests/rag-fixture-retrieval.test.ts(7,12): error TS2352: Conversion of type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' but required in type 'VectorizeMatches'.
tests/rag-retrieval.test.ts(9,12): error TS2352: Conversion of type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' but required in type 'VectorizeMatches'.
tests/rag-vectorize-upsert.test.ts(15,12): error TS2352: Conversion of type '{ count: number; }' to type 'VectorizeAsyncMutation' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'mutationId' is missing in type '{ count: number; }' but required in type 'VectorizeAsyncMutation'.
tests/rag-vectorize-upsert.test.ts(20,12): error TS2352: Conversion of type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: { id: string; score: number; metadata: { tenantId: string; docId: string; chunkId: string; }; }[]; }' but required in type 'VectorizeMatches'.
tests/search-caching.test.ts(68,48): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(89,52): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(90,52): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(108,51): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(127,49): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(141,48): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(154,48): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/search-caching.test.ts(173,49): error TS2345: Argument of type '{ status: string; answer: string; sources: never[]; confidence: number; followUps: never[]; }' is not assignable to parameter of type '{ status: "ok"; answer: string; sources: { docId: string; text: string; id: string; chunkId: string; source?: string | undefined; title?: string | undefined; url?: string | undefined; score?: number | undefined; }[]; confidence: number; followUps: string[]; traceId?: string | undefined; }'.
  Types of property 'status' are incompatible.
    Type 'string' is not assignable to type '"ok"'.
tests/vectorize-tenant-scope.test.ts(10,12): error TS2352: Conversion of type '{ matches: never[]; }' to type 'VectorizeMatches' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'count' is missing in type '{ matches: never[]; }' but required in type 'VectorizeMatches'.
tests/vectorize-tenant-scope.test.ts(15,12): error TS2352: Conversion of type '{ count: number; }' to type 'VectorizeAsyncMutation' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.
  Property 'mutationId' is missing in type '{ count: number; }' but required in type 'VectorizeAsyncMutation'.
